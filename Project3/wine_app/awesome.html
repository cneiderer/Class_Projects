<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Wine Quality Predictor</title>
    <link rel="stylesheet" href="static/d3.slider.css" />
    <style>

     body {
       font-family: Verdana,Arial,sans-serif;
     }

     h2 {
       font-size: 1.2em;
       margin: 25px 0 5px 0;
       color: gray
     }

     .space {
       margin-bottom: 20 px;
     }

     .wrapper {
       width: 800px;
       margin-left: auto;
       margin-right: auto;
       margin-bottom: 0px;
     }

     #bar_chart {
       margin-bottom: 0 px;
     }

     .bar {
       fill: rgb(70, 12, 62);
     }

     span {
       color: steelblue;
     }

    </style>
  </head>

  <body>


    <div id="chart_area" class="wrapper">

      <h2>Low Quality</h2>
      <p class="space"></p>
      <div id="bar_chart1">
      </div>

      <h2>Mid Quality</h2>
      <p class="space"></p>
      <div id="bar_chart2">
      </div>

      <h2>High Quality</h2>
      <p class="space"></p>
      <div id="bar_chart3">
      </div>

    </div>

    <div id="sliders" class="wrapper">

      <h2 class="feature">Fixed Acidity: <span id="fixed_acidity">9.6</span></h2>
      <div id="fixed_acidity_slider"></div>

      <h2 class="feature">Volatile Acidity: <span id="volatile_acidity">0.51</span></h2>
      <div id="volatile_acidity_slider"></div>

      <h2 class="feature">Citric Acid: <span id="citric_acid">0.61</span></h2>
      <div id="citric_acid_slider"></div>

      <h2 class="feature">Residual Sugar: <span id="residual_sugar">7.4</span></h2>
      <div id="residual_sugar_slider"></div>

      <h2 class="feature">Chlorides: <span id="chlorides">0.434</span></h2>
      <div id="chlorides_slider"></div>

      <h2 class="feature">Free Sulphur Dioxide: <span id="free_so2">32</span></h2>
      <div id="free_so2_slider"></div>

      <h2 class="feature">Total Sulphur Dioxide: <span id="total_so2">133</span></h2>
      <div id="total_so2_slider"></div>

      <h2 class="feature">Density: <span id="density">0.998</span></h2>
      <div id="density_slider"></div>

      <h2 class="feature">pH: <span id="ph">3.25</span></h2>
      <div id="ph_slider"></div>

      <h2 class="feature">Sulphates: <span id="sulphates">1.16</span></h2>
      <div id="sulphates_slider"></div>

      <h2 class="feature">Alcohol: <span id="alcohol">13.6</span></h2>
      <div id="alcohol_slider"></div>

    </div>

    <!-- Import the libraries: jQuery, d3, d3.slider -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="static/d3.slider.js"></script>

    <script>

      <!-- SINGLE BAR CHART -->

      var current_fixed_acidity = 9.6;
      var current_volatile_acidity = 0.51;
      var current_citric_acid = 0.61;
      var current_residual_sugar = 7.4;
      var current_chlorides = 0.434;
      var current_free_so2 = 32;
      var current_total_so2 = 133;
      var current_density = 0.998;
      var current_ph = 3.25;
      var current_sulphates = 1.16;
      var current_alcohol = 13.6;

      var current_bar1 = 48.4
      var current_bar2 = 21.9
      var current_bar3 = 29.7

      <!-- BAR1 CHART -->

     var chart = d3.select("#bar_chart1")
                   .append("svg:svg")
                   .attr("width", 800)
                   .attr("height", 50);

     var chance_scale = d3.scale.linear()
                                .domain([0, 100])
                                .range([0, 800]);

     var bar = chart.append("g")
                    .attr("class", "bar")

       bar.append("svg:rect")
          .attr("id", "chancebar1")
          .attr("class", "bar")
          .attr("width", chance_scale(current_bar1))
          .attr("height", 50);

     bar.append("text")
        .attr("id", "percent_text1")
        .attr("dy", ".75em")
        .attr("y", 15)
        .attr("x", chance_scale(current_bar1-5))
        .attr("text-anchor", "middle")
        .attr("fill", "white")
        .attr("font-size", 20)
        .text( current_bar1.toFixed(1) + "%");      

     <!-- BAR2 CHART -->

    var chart = d3.select("#bar_chart2")
                  .append("svg:svg")
                  .attr("width", 800)
                  .attr("height", 50);

    var chance_scale = d3.scale.linear()
                              .domain([0, 100])
                              .range([0, 800]);

    var bar = chart.append("g")
                  .attr("class", "bar")

      bar.append("svg:rect")
        .attr("id", "chancebar2")
        .attr("class", "bar")
        .attr("width", chance_scale(current_bar2))
        .attr("height", 50);

    bar.append("text")
      .attr("id", "percent_text2")
      .attr("dy", ".75em")
      .attr("y", 15)
      .attr("x", chance_scale(current_bar2-5))
      .attr("text-anchor", "middle")
      .attr("fill", "white")
      .attr("font-size", 20)
      .text( current_bar2.toFixed(1) + "%");           

     <!-- BAR3 CHART -->

    var chart = d3.select("#bar_chart3")
                  .append("svg:svg")
                  .attr("width", 800)
                  .attr("height", 50);

    var chance_scale = d3.scale.linear()
                              .domain([0, 100])
                              .range([0, 800]);

    var bar = chart.append("g")
                  .attr("class", "bar")

      bar.append("svg:rect")
        .attr("id", "chancebar3")
        .attr("class", "bar")
        .attr("width", chance_scale(current_bar3))
        .attr("height", 50);

    bar.append("text")
      .attr("id", "percent_text3")
      .attr("dy", ".75em")
      .attr("y", 10)
      .attr("x", chance_scale(current_bar3-5))
      .attr("text-anchor", "middle")
      .attr("fill", "white")
      .attr("font-size", 20)
      .text( current_bar3.toFixed(1) + "%");     

     <!-- FUNCTION TO GET CHANCE FROM YOUR PREDICTOR WITH AJAX AND CHANGE BAR  HEIGHT -->

     function getAndDrawQualityPct(fixed_acidity, 
                                   volatile_acidity, 
                                   citric_acid, 
                                   residual_sugar, 
                                   chlorides, 
                                   free_so2, 
                                   total_so2, 
                                   density, 
                                   ph, 
                                   sulphates, 
                                   alcohol){

      $.ajax({
        type: "POST",
        contentType: "application/json; charset=utf-8",
        url: "/score",
        dataType: "json",
        async: true,
        data: "{\"example\": ["+fixed_acidity+","
                               +volatile_acidity+","
                               +citric_acid+","
                               +residual_sugar+","
                               +chlorides+","
                               +free_so2+","
                               +total_so2+","
                               +density+","
                               +ph+","
                               +sulphates+","
                               +alcohol+"]}",
        success: function (data) {
          
          var chance1 = data["score1"] * 100
          d3.select("#chancebar1")
            .attr("width", chance_scale(chance1));
          d3.select("#percent_text1")
            .attr("x", chance_scale(chance1-5))
            .text(chance1.toFixed(1) + "%");
          
          var chance2 = data["score2"] * 100
          d3.select("#chancebar2")
            .attr("width", chance_scale(chance2));
          d3.select("#percent_text2")
            .attr("x", chance_scale(chance2-5))
            .text(chance2.toFixed(1) + "%");
          
          var chance3 = data["score3"] * 100
          d3.select("#chancebar3")
            .attr("width", chance_scale(chance3));
          d3.select("#percent_text3")
            .attr("x", chance_scale(chance3-5))
            .text(chance3.toFixed(1) + "%");
        },
        error: function (result) {
        }
      })
      }

     <!-- SLIDERS -->

      d3.select('#fixed_acidity_slider')
        .call(
          d3.slider()
            .value(current_fixed_acidity)
            .step(0.1)
            .min(4.6)
            .max(15.9)
            .axis(true)
            .on("slide", function(evt,value) {
              d3.select('#fixed_acidity').text(value.toFixed(1));
              current_fixed_acidity = value;
              getAndDrawQualityPct(current_fixed_acidity, 
                                   current_volatile_acidity,
                                   current_citric_acid,
                                   current_residual_sugar,
                                   current_chlorides,
                                   current_free_so2,
                                   current_total_so2,
                                   current_density,
                                   current_ph,
                                   current_sulphates,
                                   current_alcohol)
            }
            )
        );

      d3.select('#volatile_acidity_slider')
        .call(
          d3.slider()
            .value(current_volatile_acidity)
            .step(0.01)
            .min(0.12)
            .max(1.58)
            .axis(true)
            .on("slide", function(evt,value) {
              d3.select('#volatile_acidity').text(value.toFixed(2));
              current_volatile_acidity = value;
              getAndDrawQualityPct(current_fixed_acidity, 
                                   current_volatile_acidity,
                                   current_citric_acid,
                                   current_residual_sugar,
                                   current_chlorides,
                                   current_free_so2,
                                   current_total_so2,
                                   current_density,
                                   current_ph,
                                   current_sulphates,
                                   current_alcohol)
            }
            )
        );

      d3.select('#citric_acid_slider')
        .call(
          d3.slider()
            .value(current_citric_acid)
            .step(0.01)
            .min(0.0)
            .max(1.0)
            .axis(true)
            .on("slide", function(evt,value) {
              d3.select('#citric_acid').text(value.toFixed(2));
              current_citric_acid = value;
              getAndDrawQualityPct(current_fixed_acidity, 
                                   current_volatile_acidity,
                                   current_citric_acid,
                                   current_residual_sugar,
                                   current_chlorides,
                                   current_free_so2,
                                   current_total_so2,
                                   current_density,
                                   current_ph,
                                   current_sulphates,
                                   current_alcohol)
            }
            )
        );

      d3.select('#residual_sugar_slider')
        .call(
          d3.slider()
            .value(current_residual_sugar)
            .step(0.1)
            .min(0.9)
            .max(15.5)
            .axis(true)
            .on("slide", function(evt,value) {
              d3.select('#residual_sugar').text(value.toFixed(1));
              current_residual_sugar = value;
              getAndDrawQualityPct(current_fixed_acidity, 
                                   current_volatile_acidity,
                                   current_citric_acid,
                                   current_residual_sugar,
                                   current_chlorides,
                                   current_free_so2,
                                   current_total_so2,
                                   current_density,
                                   current_ph,
                                   current_sulphates,
                                   current_alcohol)
            }
            )
        );

      d3.select('#chlorides_slider')
        .call(
          d3.slider()
            .value(current_chlorides)
            .step(0.001)
            .min(0.020)
            .max(0.611)
            .axis(true)
            .on("slide", function(evt,value) {
              d3.select('#chlorides').text(value.toFixed(3));
              current_chlorides = value;
              getAndDrawQualityPct(current_fixed_acidity, 
                                   current_volatile_acidity,
                                   current_citric_acid,
                                   current_residual_sugar,
                                   current_chlorides,
                                   current_free_so2,
                                   current_total_so2,
                                   current_density,
                                   current_ph,
                                   current_sulphates,
                                   current_alcohol)
            }
            )
        );

      d3.select('#free_so2_slider')
        .call(
          d3.slider()
            .value(current_free_so2)
            .step(1)
            .min(1)
            .max(72)
            .axis(true)
            .on("slide", function(evt,value) {
              d3.select('#free_so2').text(value.toFixed(0));
              current_free_so2 = value;
              getAndDrawQualityPct(current_fixed_acidity, 
                                   current_volatile_acidity,
                                   current_citric_acid,
                                   current_residual_sugar,
                                   current_chlorides,
                                   current_free_so2,
                                   current_total_so2,
                                   current_density,
                                   current_ph,
                                   current_sulphates,
                                   current_alcohol)
            }
            )
        );

      d3.select('#total_so2_slider')
        .call(
          d3.slider()
            .value(current_total_so2)
            .step(1)
            .min(6)
            .max(289)
            .axis(true)
            .on("slide", function(evt,value) {
              d3.select('#total_so2').text(value.toFixed(0));
              current_total_so2 = value;
              getAndDrawQualityPct(current_fixed_acidity, 
                                   current_volatile_acidity,
                                   current_citric_acid,
                                   current_residual_sugar,
                                   current_chlorides,
                                   current_free_so2,
                                   current_total_so2,
                                   current_density,
                                   current_ph,
                                   current_sulphates,
                                   current_alcohol)
            }
            )
        );        

      d3.select('#density_slider')
        .call(
          d3.slider()
            .value(current_density)
            .step(0.001)
            .min(0.990)
            .max(1.004)
            .axis(true)
            .on("slide", function(evt,value) {
              d3.select('#density').text(value.toFixed(3));
              current_density = value;
              getAndDrawQualityPct(current_fixed_acidity, 
                                   current_volatile_acidity,
                                   current_citric_acid,
                                   current_residual_sugar,
                                   current_chlorides,
                                   current_free_so2,
                                   current_total_so2,
                                   current_density,
                                   current_ph,
                                   current_sulphates,
                                   current_alcohol)
            }
            )
        );

      d3.select('#ph_slider')
        .call(
          d3.slider()
            .value(current_ph)
            .step(0.01)
            .min(2.74)
            .max(4.01)
            .axis(true)
            .on("slide", function(evt,value) {
              d3.select('#ph').text(value.toFixed(2));
              current_ph = value;
              getAndDrawQualityPct(current_fixed_acidity, 
                                   current_volatile_acidity,
                                   current_citric_acid,
                                   current_residual_sugar,
                                   current_chlorides,
                                   current_free_so2,
                                   current_total_so2,
                                   current_density,
                                   current_ph,
                                   current_sulphates,
                                   current_alcohol)
            }
            )
        );

      d3.select('#sulphates_slider')
        .call(
          d3.slider()
            .value(current_sulphates)
            .step(0.01)
            .min(0.33)
            .max(2.00)
            .axis(true)
            .on("slide", function(evt,value) {
              d3.select('#sulphates').text(value.toFixed(2));
              current_sulphates = value;
              getAndDrawQualityPct(current_fixed_acidity, 
                                   current_volatile_acidity,
                                   current_citric_acid,
                                   current_residual_sugar,
                                   current_chlorides,
                                   current_free_so2,
                                   current_total_so2,
                                   current_density,
                                   current_ph,
                                   current_sulphates,
                                   current_alcohol)
            }
            )
        );

      d3.select('#alcohol_slider')
        .call(
          d3.slider()
            .value(current_alcohol)
            .step(0.1)
            .min(8.4)
            .max(14.9)
            .axis(true)
            .on("slide", function(evt,value) {
              d3.select('#alcohol').text(value.toFixed(1));
              current_alcohol = value;
              getAndDrawQualityPct(current_fixed_acidity, 
                                   current_volatile_acidity,
                                   current_citric_acid,
                                   current_residual_sugar,
                                   current_chlorides,
                                   current_free_so2,
                                   current_total_so2,
                                   current_density,
                                   current_ph,
                                   current_sulphates,
                                   current_alcohol)
            }
            )
        );

    </script>
  </body>
</html>
